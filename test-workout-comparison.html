<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Workout Comparison Utilities Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
      }
      .test-result {
        margin: 10px 0;
        padding: 15px;
        border-radius: 8px;
      }
      .success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .warning {
        background-color: #fff3cd;
        color: #856404;
        border: 1px solid #ffeaa7;
      }
      .error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .info {
        background-color: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
      .test-section {
        margin: 20px 0;
        padding: 20px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      button {
        padding: 12px 20px;
        margin: 8px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
      }
      button:hover {
        background: #0056b3;
      }
      button.secondary {
        background: #6c757d;
      }
      button.success {
        background: #28a745;
      }
      .comparison-display {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin: 10px 0;
      }
      .similarity-score {
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        padding: 10px;
        border-radius: 5px;
        margin: 10px 0;
      }
      .score-high {
        background: #d4edda;
        color: #155724;
      }
      .score-medium {
        background: #fff3cd;
        color: #856404;
      }
      .score-low {
        background: #f8d7da;
        color: #721c24;
      }
      .workout-card {
        background: white;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 15px;
        margin: 10px 0;
      }
      .workout-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }
      .progression-chart {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin: 10px 0;
      }
      .trend-up {
        color: #28a745;
        font-weight: bold;
      }
      .trend-down {
        color: #dc3545;
        font-weight: bold;
      }
      .trend-stable {
        color: #6c757d;
        font-weight: bold;
      }
      .similar-workout {
        background: #e7f3ff;
        border-left: 4px solid #007bff;
        padding: 10px;
        margin: 5px 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üîç Workout Comparison Utilities Test</h1>

      <div class="test-section">
        <h2>Setup Test Data</h2>
        <button onclick="createTestWorkouts()">Create Test Workouts</button>
        <button onclick="showWorkoutList()">Show Current Workouts</button>
        <button class="secondary" onclick="clearAllWorkouts()">
          Clear All Workouts
        </button>
        <div id="workout-list"></div>
      </div>

      <div class="test-section">
        <h2>Workout Comparison</h2>
        <button onclick="testWorkoutComparison()">Compare Two Workouts</button>
        <button onclick="testSimilarityScoring()">
          Test Similarity Scoring
        </button>
        <div id="comparison-results"></div>
      </div>

      <div class="test-section">
        <h2>Similar Workout Finding</h2>
        <button onclick="testFindSimilarWorkouts()">
          Find Similar Workouts
        </button>
        <button onclick="testSimilarityRanking()">
          Test Similarity Ranking
        </button>
        <div id="similarity-results"></div>
      </div>

      <div class="test-section">
        <h2>Progression Analysis</h2>
        <button onclick="testProgressionAnalysis()">
          Analyze Workout Progression
        </button>
        <button onclick="testVolumeProgression()">
          Test Volume Progression
        </button>
        <button class="success" onclick="runFullComparisonTest()">
          Run Complete Comparison Test
        </button>
        <div id="progression-results"></div>
      </div>

      <div id="results"></div>
    </div>

    <script src="js/modules/storageManager.js"></script>
    <script src="js/modules/workoutHistory.js"></script>
    <script>
      // Initialize modules
      StorageManager.init();
      WorkoutHistory.init();

      let testWorkoutIds = [];

      function addResult(message, type = "info") {
        const results = document.getElementById("results");
        const div = document.createElement("div");
        div.className = `test-result ${type}`;
        div.innerHTML = message;
        results.appendChild(div);
        results.scrollTop = results.scrollHeight;
      }

      function createTestWorkouts() {
        addResult("=== Creating Test Workouts ===");

        try {
          // Clear existing workouts first
          WorkoutHistory.clearHistory();
          testWorkoutIds = [];

          // Create diverse test workouts
          const testWorkouts = [
            {
              name: "Upper Body Strength",
              exercises: [
                {
                  name: "Bench Press",
                  muscleGroup: "chest",
                  sets: 4,
                  reps: 8,
                  isCompound: true,
                },
                {
                  name: "Pull-ups",
                  muscleGroup: "back",
                  sets: 3,
                  reps: 10,
                  isCompound: true,
                },
                {
                  name: "Shoulder Press",
                  muscleGroup: "shoulders",
                  sets: 3,
                  reps: 12,
                  isCompound: true,
                },
                {
                  name: "Bicep Curls",
                  muscleGroup: "arms",
                  sets: 3,
                  reps: 12,
                  isCompound: false,
                },
              ],
              settings: { difficulty: "intermediate", workoutType: "strength" },
            },
            {
              name: "Similar Upper Body",
              exercises: [
                {
                  name: "Push-ups",
                  muscleGroup: "chest",
                  sets: 3,
                  reps: 15,
                  isCompound: true,
                },
                {
                  name: "Bent-over Rows",
                  muscleGroup: "back",
                  sets: 3,
                  reps: 12,
                  isCompound: true,
                },
                {
                  name: "Overhead Press",
                  muscleGroup: "shoulders",
                  sets: 3,
                  reps: 10,
                  isCompound: true,
                },
                {
                  name: "Tricep Dips",
                  muscleGroup: "arms",
                  sets: 3,
                  reps: 15,
                  isCompound: false,
                },
              ],
              settings: { difficulty: "intermediate", workoutType: "strength" },
            },
            {
              name: "Lower Body Focus",
              exercises: [
                {
                  name: "Squats",
                  muscleGroup: "legs",
                  sets: 4,
                  reps: 12,
                  isCompound: true,
                },
                {
                  name: "Deadlifts",
                  muscleGroup: "legs",
                  sets: 3,
                  reps: 8,
                  isCompound: true,
                },
                {
                  name: "Lunges",
                  muscleGroup: "legs",
                  sets: 3,
                  reps: 12,
                  isCompound: true,
                },
                {
                  name: "Calf Raises",
                  muscleGroup: "legs",
                  sets: 3,
                  reps: 20,
                  isCompound: false,
                },
              ],
              settings: { difficulty: "advanced", workoutType: "strength" },
            },
            {
              name: "Full Body Cardio",
              exercises: [
                {
                  name: "Burpees",
                  muscleGroup: "core",
                  sets: 3,
                  reps: 15,
                  isCompound: true,
                },
                {
                  name: "Mountain Climbers",
                  muscleGroup: "core",
                  sets: 3,
                  reps: 30,
                  isCompound: true,
                },
                {
                  name: "Jumping Jacks",
                  muscleGroup: "core",
                  sets: 3,
                  reps: 30,
                  isCompound: true,
                },
                {
                  name: "High Knees",
                  muscleGroup: "legs",
                  sets: 3,
                  reps: 30,
                  isCompound: false,
                },
              ],
              settings: { difficulty: "beginner", workoutType: "cardio" },
            },
            {
              name: "Progressive Upper Body",
              exercises: [
                {
                  name: "Bench Press",
                  muscleGroup: "chest",
                  sets: 5,
                  reps: 6,
                  isCompound: true,
                },
                {
                  name: "Pull-ups",
                  muscleGroup: "back",
                  sets: 4,
                  reps: 8,
                  isCompound: true,
                },
                {
                  name: "Shoulder Press",
                  muscleGroup: "shoulders",
                  sets: 4,
                  reps: 10,
                  isCompound: true,
                },
                {
                  name: "Bicep Curls",
                  muscleGroup: "arms",
                  sets: 4,
                  reps: 10,
                  isCompound: false,
                },
                {
                  name: "Tricep Extensions",
                  muscleGroup: "arms",
                  sets: 3,
                  reps: 12,
                  isCompound: false,
                },
              ],
              settings: { difficulty: "advanced", workoutType: "strength" },
            },
          ];

          // Add workouts with slight delays to ensure different timestamps
          testWorkouts.forEach((workout, index) => {
            setTimeout(() => {
              const session = WorkoutHistory.addWorkout(
                { exercises: workout.exercises },
                workout.settings
              );
              testWorkoutIds.push(session.id);
              addResult(
                `‚úÖ Created: ${workout.name} (${session.id.substring(
                  0,
                  8
                )}...)`,
                "success"
              );

              if (index === testWorkouts.length - 1) {
                setTimeout(() => {
                  showWorkoutList();
                  addResult(
                    `‚úÖ Created ${testWorkouts.length} test workouts for comparison`,
                    "success"
                  );
                }, 100);
              }
            }, index * 100);
          });
        } catch (error) {
          addResult(
            `‚ùå Failed to create test workouts: ${error.message}`,
            "error"
          );
        }
      }

      function showWorkoutList() {
        try {
          const workouts = WorkoutHistory.getHistory();
          const listDiv = document.getElementById("workout-list");

          if (workouts.length === 0) {
            listDiv.innerHTML =
              "<p>No workouts available. Create test workouts first.</p>";
            return;
          }

          let html = "<h4>Available Workouts:</h4>";
          workouts.forEach((workout, index) => {
            const title =
              (workout.summary && workout.summary.title) || "Untitled Workout";
            const relativeTime =
              (workout.metadata && workout.metadata.relativeTime) ||
              "Unknown Time";
            const muscleGroups =
              (workout.settings && workout.settings.muscleGroups) || [];
            const totalVolume =
              (workout.stats && workout.stats.totalVolume) || 0;

            html += `
                        <div class="workout-card">
                            <strong>${index + 1}. ${title}</strong><br>
                            <small>ID: ${workout.id.substring(
                              0,
                              12
                            )}... | ${relativeTime}</small><br>
                            Exercises: ${workout.exercises.length} |
                            Muscle Groups: ${muscleGroups.join(", ")} |
                            Volume: ${totalVolume} reps
                        </div>
                    `;
          });

          listDiv.innerHTML = html;
        } catch (error) {
          addResult(
            `‚ùå Failed to show workout list: ${error.message}`,
            "error"
          );
        }
      }

      function testWorkoutComparison() {
        addResult("=== Testing Workout Comparison ===");

        try {
          const workouts = WorkoutHistory.getHistory();

          if (workouts.length < 2) {
            addResult(
              "Need at least 2 workouts for comparison. Create test workouts first.",
              "warning"
            );
            return;
          }

          // Compare first two workouts
          const workout1 = workouts[0];
          const workout2 = workouts[1];

          const comparison = WorkoutHistory.compareWorkouts(
            workout1.id,
            workout2.id
          );

          const scoreClass =
            comparison.similarities.overallSimilarity >= 70
              ? "score-high"
              : comparison.similarities.overallSimilarity >= 40
              ? "score-medium"
              : "score-low";

          const resultsDiv = document.getElementById("comparison-results");
          resultsDiv.innerHTML = `
                    <div class="comparison-display">
                        <h4>üîç Workout Comparison Results</h4>
                        
                        <div class="workout-grid">
                            <div class="workout-card">
                                <h5>Workout 1: ${comparison.workout1.title}</h5>
                                <p>Date: ${comparison.workout1.date}</p>
                                <p>Exercises: ${
                                  comparison.workout1.exercises
                                }</p>
                                <p>Muscle Groups: ${comparison.workout1.muscleGroups.join(
                                  ", "
                                )}</p>
                                <p>Volume: ${
                                  comparison.workout1.volume
                                } reps</p>
                                <p>Difficulty: ${
                                  comparison.workout1.difficulty
                                }</p>
                            </div>
                            <div class="workout-card">
                                <h5>Workout 2: ${comparison.workout2.title}</h5>
                                <p>Date: ${comparison.workout2.date}</p>
                                <p>Exercises: ${
                                  comparison.workout2.exercises
                                }</p>
                                <p>Muscle Groups: ${comparison.workout2.muscleGroups.join(
                                  ", "
                                )}</p>
                                <p>Volume: ${
                                  comparison.workout2.volume
                                } reps</p>
                                <p>Difficulty: ${
                                  comparison.workout2.difficulty
                                }</p>
                            </div>
                        </div>
                        
                        <div class="similarity-score ${scoreClass}">
                            Overall Similarity: ${
                              comparison.similarities.overallSimilarity
                            }%
                        </div>
                        
                        <div class="workout-card">
                            <h5>üìä Detailed Comparison</h5>
                            <p><strong>Exercise Similarity:</strong> ${
                              comparison.similarities.exerciseSimilarity
                            }%</p>
                            <p><strong>Muscle Group Similarity:</strong> ${
                              comparison.similarities.muscleSimilarity
                            }%</p>
                            <p><strong>Common Exercises:</strong> ${
                              comparison.similarities.commonExercises.join(
                                ", "
                              ) || "None"
                            }</p>
                            <p><strong>Common Muscle Groups:</strong> ${
                              comparison.similarities.commonMuscleGroups.join(
                                ", "
                              ) || "None"
                            }</p>
                            <p><strong>Same Difficulty:</strong> ${
                              comparison.similarities.sameDifficulty
                                ? "Yes"
                                : "No"
                            }</p>
                            <p><strong>Volume Difference:</strong> ${
                              comparison.similarities.volumeDifference
                            } reps (${
            comparison.similarities.volumePercentDiff
          }%)</p>
                            <p><strong>Recommendation:</strong> ${
                              comparison.recommendation
                            }</p>
                        </div>
                    </div>
                `;

          const title1 = comparison.workout1.title || "Untitled Workout";
          const title2 = comparison.workout2.title || "Untitled Workout";
          addResult(
            `‚úÖ Compared "${title1}" vs "${title2}" - ${comparison.similarities.overallSimilarity}% similar`,
            "success"
          );
        } catch (error) {
          addResult(`‚ùå Failed to compare workouts: ${error.message}`, "error");
        }
      }

      function testFindSimilarWorkouts() {
        addResult("=== Testing Find Similar Workouts ===");

        try {
          const workouts = WorkoutHistory.getHistory();

          if (workouts.length < 2) {
            addResult(
              "Need at least 2 workouts to find similarities. Create test workouts first.",
              "warning"
            );
            return;
          }

          // Find similar workouts to the first one
          const referenceWorkout = workouts[0];
          const similarWorkouts = WorkoutHistory.findSimilarWorkouts(
            referenceWorkout.id,
            3
          );

          const resultsDiv = document.getElementById("similarity-results");
          const referenceTitle =
            (referenceWorkout.summary && referenceWorkout.summary.title) ||
            "Untitled Workout";
          let html = `
                    <div class="comparison-display">
                        <h4>üéØ Similar Workouts to "${referenceTitle}"</h4>
                        <div class="workout-card">
                            <h5>Reference Workout</h5>
                            <p>Exercises: ${
                              referenceWorkout.exercises.length
                            }</p>
                            <p>Muscle Groups: ${(
                              (referenceWorkout.settings &&
                                referenceWorkout.settings.muscleGroups) ||
                              []
                            ).join(", ")}</p>
                            <p>Volume: ${
                              (referenceWorkout.stats &&
                                referenceWorkout.stats.totalVolume) ||
                              0
                            } reps</p>
                        </div>
                `;

          if (similarWorkouts.length === 0) {
            html += "<p>No similar workouts found.</p>";
          } else {
            html += "<h5>Similar Workouts (ranked by similarity):</h5>";
            similarWorkouts.forEach((similar, index) => {
              const scoreClass =
                similar.similarity >= 70
                  ? "score-high"
                  : similar.similarity >= 40
                  ? "score-medium"
                  : "score-low";

              html += `
                            <div class="similar-workout">
                                <strong>${index + 1}. ${
                similar.workout.title
              }</strong>
                                <span class="similarity-score ${scoreClass}" style="float: right; font-size: 16px; padding: 5px 10px;">
                                    ${similar.similarity}% similar
                                </span>
                                <br>
                                <small>${similar.workout.relativeTime} | ${
                similar.workout.exercises
              } exercises</small><br>
                                <small>Common exercises: ${
                                  similar.commonExercises
                                } | Common muscle groups: ${
                similar.commonMuscleGroups
              }</small><br>
                                <small>Muscle Groups: ${similar.workout.muscleGroups.join(
                                  ", "
                                )}</small><br>
                                <small>Assessment: ${
                                  similar.recommendation
                                }</small>
                            </div>
                        `;
            });
          }

          html += "</div>";
          resultsDiv.innerHTML = html;

          addResult(
            `‚úÖ Found ${similarWorkouts.length} similar workout${
              similarWorkouts.length !== 1 ? "s" : ""
            } to "${referenceTitle}"`,
            "success"
          );
        } catch (error) {
          addResult(
            `‚ùå Failed to find similar workouts: ${error.message}`,
            "error"
          );
        }
      }

      function testProgressionAnalysis() {
        addResult("=== Testing Progression Analysis ===");

        try {
          const progression = WorkoutHistory.analyzeWorkoutProgression();

          if (progression.progression === "insufficient-data") {
            addResult(
              `${progression.message}. Create more test workouts.`,
              "warning"
            );
            return;
          }

          const trendClass =
            progression.progression === "increasing"
              ? "trend-up"
              : progression.progression === "decreasing"
              ? "trend-down"
              : "trend-stable";

          const resultsDiv = document.getElementById("progression-results");
          resultsDiv.innerHTML = `
                    <div class="progression-chart">
                        <h4>üìà Workout Progression Analysis</h4>
                        
                        <div class="workout-card">
                            <h5>Overview</h5>
                            <p><strong>Workouts Analyzed:</strong> ${
                              progression.workoutCount
                            }</p>
                            <p><strong>Time Period:</strong> ${
                              progression.timespan.start
                            } to ${progression.timespan.end} (${
            progression.timespan.days
          } days)</p>
                            <p><strong>Overall Trend:</strong> <span class="${trendClass}">${progression.progression.toUpperCase()}</span></p>
                            <p><strong>Recommendation:</strong> ${
                              progression.recommendation
                            }</p>
                        </div>
                        
                        <div class="workout-grid">
                            <div class="workout-card">
                                <h5>üìä Volume Analysis</h5>
                                <p><strong>Total Volume:</strong> ${
                                  progression.volume.total
                                } reps</p>
                                <p><strong>Average Volume:</strong> ${
                                  progression.volume.average
                                } reps</p>
                                <p><strong>Highest:</strong> ${
                                  progression.volume.highest
                                } reps</p>
                                <p><strong>Lowest:</strong> ${
                                  progression.volume.lowest
                                } reps</p>
                                <p><strong>Trend:</strong> ${
                                  progression.volume.trend > 0 ? "+" : ""
                                }${progression.volume.trend.toFixed(
            1
          )} reps per workout</p>
                            </div>
                            <div class="workout-card">
                                <h5>üèãÔ∏è Exercise Analysis</h5>
                                <p><strong>Average Exercises:</strong> ${
                                  progression.exercises.average
                                }</p>
                                <p><strong>Highest:</strong> ${
                                  progression.exercises.highest
                                } exercises</p>
                                <p><strong>Lowest:</strong> ${
                                  progression.exercises.lowest
                                } exercises</p>
                                <p><strong>Trend:</strong> ${
                                  progression.exercises.trend > 0 ? "+" : ""
                                }${progression.exercises.trend.toFixed(
            1
          )} exercises per workout</p>
                            </div>
                        </div>
                        
                        <div class="workout-card">
                            <h5>üéØ Diversity Analysis</h5>
                            <p><strong>Average Muscle Groups:</strong> ${
                              progression.diversity.average
                            }</p>
                            <p><strong>Highest:</strong> ${
                              progression.diversity.highest
                            } muscle groups</p>
                            <p><strong>Lowest:</strong> ${
                              progression.diversity.lowest
                            } muscle groups</p>
                        </div>
                    </div>
                `;

          addResult(
            `‚úÖ Analyzed progression for ${progression.workoutCount} workouts - Trend: ${progression.progression}`,
            "success"
          );
        } catch (error) {
          addResult(
            `‚ùå Failed to analyze progression: ${error.message}`,
            "error"
          );
        }
      }

      function runFullComparisonTest() {
        addResult("=== Running Complete Comparison Test ===");

        createTestWorkouts();

        setTimeout(() => {
          addResult("Step 1: Testing workout comparison...", "info");
          testWorkoutComparison();

          setTimeout(() => {
            addResult("Step 2: Testing similar workout finding...", "info");
            testFindSimilarWorkouts();

            setTimeout(() => {
              addResult("Step 3: Testing progression analysis...", "info");
              testProgressionAnalysis();

              setTimeout(() => {
                addResult(
                  "‚úÖ Complete comparison test finished successfully!",
                  "success"
                );
              }, 500);
            }, 500);
          }, 500);
        }, 2000); // Wait for test workouts to be created
      }

      function clearAllWorkouts() {
        try {
          WorkoutHistory.clearHistory();
          testWorkoutIds = [];
          document.getElementById("workout-list").innerHTML = "";
          document.getElementById("comparison-results").innerHTML = "";
          document.getElementById("similarity-results").innerHTML = "";
          document.getElementById("progression-results").innerHTML = "";
          addResult("‚úÖ All workouts cleared", "success");
        } catch (error) {
          addResult(`‚ùå Failed to clear workouts: ${error.message}`, "error");
        }
      }

      // Additional test functions
      function testSimilarityScoring() {
        addResult("=== Testing Similarity Scoring Edge Cases ===");

        try {
          const workouts = WorkoutHistory.getHistory();
          if (workouts.length < 2) {
            addResult(
              "Need test workouts for similarity scoring test",
              "warning"
            );
            return;
          }

          // Test all pairwise comparisons
          let totalComparisons = 0;
          let highSimilarity = 0;
          let mediumSimilarity = 0;
          let lowSimilarity = 0;

          for (let i = 0; i < workouts.length; i++) {
            for (let j = i + 1; j < workouts.length; j++) {
              const comparison = WorkoutHistory.compareWorkouts(
                workouts[i].id,
                workouts[j].id
              );
              totalComparisons++;

              if (comparison.similarities.overallSimilarity >= 70)
                highSimilarity++;
              else if (comparison.similarities.overallSimilarity >= 40)
                mediumSimilarity++;
              else lowSimilarity++;
            }
          }

          addResult(
            `
                    <strong>üìä Similarity Scoring Results:</strong><br>
                    ‚Ä¢ Total comparisons: ${totalComparisons}<br>
                    ‚Ä¢ High similarity (70%+): ${highSimilarity}<br>
                    ‚Ä¢ Medium similarity (40-69%): ${mediumSimilarity}<br>
                    ‚Ä¢ Low similarity (<40%): ${lowSimilarity}
                `,
            "info"
          );
        } catch (error) {
          addResult(
            `‚ùå Failed similarity scoring test: ${error.message}`,
            "error"
          );
        }
      }

      function testSimilarityRanking() {
        addResult("=== Testing Similarity Ranking ===");

        try {
          const workouts = WorkoutHistory.getHistory();
          if (workouts.length < 3) {
            addResult("Need at least 3 workouts for ranking test", "warning");
            return;
          }

          // Test ranking for each workout
          workouts.forEach((workout, index) => {
            const workoutTitle =
              (workout.summary && workout.summary.title) || "Untitled Workout";
            const similar = WorkoutHistory.findSimilarWorkouts(workout.id, 2);
            addResult(
              `
                        <strong>${index + 1}. ${workoutTitle}:</strong><br>
                        ${
                          similar.length > 0
                            ? similar
                                .map(
                                  (s) =>
                                    `‚Ä¢ ${s.workout.title} (${s.similarity}% similar)`
                                )
                                .join("<br>")
                            : "‚Ä¢ No similar workouts found"
                        }
                    `,
              "info"
            );
          });
        } catch (error) {
          addResult(
            `‚ùå Failed similarity ranking test: ${error.message}`,
            "error"
          );
        }
      }

      function testVolumeProgression() {
        addResult("=== Testing Volume Progression Analysis ===");

        try {
          const workouts = WorkoutHistory.getHistory();
          if (workouts.length < 2) {
            addResult(
              "Need at least 2 workouts for volume progression test",
              "warning"
            );
            return;
          }

          // Analyze specific workout IDs
          const workoutIds = workouts.map((w) => w.id);
          const progression =
            WorkoutHistory.analyzeWorkoutProgression(workoutIds);

          if (progression.progression !== "insufficient-data") {
            addResult(
              `
                        <strong>üìà Volume Progression Details:</strong><br>
                        ‚Ä¢ Total volume: ${progression.volume.total} reps<br>
                        ‚Ä¢ Volume trend: ${
                          progression.volume.trend > 0 ? "+" : ""
                        }${progression.volume.trend.toFixed(
                1
              )} reps per workout<br>
                        ‚Ä¢ Volume range: ${progression.volume.lowest} - ${
                progression.volume.highest
              } reps<br>
                        ‚Ä¢ Exercise trend: ${
                          progression.exercises.trend > 0 ? "+" : ""
                        }${progression.exercises.trend.toFixed(
                1
              )} exercises per workout
                    `,
              "info"
            );
          }
        } catch (error) {
          addResult(
            `‚ùå Failed volume progression test: ${error.message}`,
            "error"
          );
        }
      }

      // Auto-run initial setup on page load
      window.onload = function () {
        addResult("üîç Workout Comparison Utilities Test Ready", "info");
        addResult(
          "Create test workouts first to enable comparison features",
          "info"
        );
      };
    </script>
  </body>
</html>
