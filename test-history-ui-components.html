<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>History UI Components Test - Modern Design</title>

    <!-- Import the enhanced modular CSS files -->
    <link rel="stylesheet" href="css/history.css" />

    <!-- Import test-specific styles -->
    <link rel="stylesheet" href="css/test-ui-components.css" />
  </head>
  <body>
    <div class="test-container">
      <div class="test-header">
        <h1>ðŸŽ¨ History UI Components Test</h1>
        <p>Modern, Eye-Catching Design with Manual User Interactions</p>
      </div>

      <div class="test-content">
        <div class="test-section">
          <h2>ðŸ§ª Component Testing</h2>
          <button class="test-button" onclick="testEmptyState()">
            Test Empty State
          </button>
          <button class="test-button" onclick="testWithSampleData()">
            Test with Sample Workouts
          </button>
          <button class="test-button danger" onclick="testClearHistory()">
            Test Clear All
          </button>
          <div id="test-status"></div>
        </div>

        <div class="test-section">
          <h2>ðŸ“± History Display</h2>
          <div id="history-display" class="history-container"></div>
        </div>
      </div>
    </div>

    <!-- Include required modules -->
    <script src="js/modules/storageManager.js"></script>
    <script src="js/modules/workoutHistory.js"></script>
    <script src="js/components/historyUI.js"></script>

    <script>
      // Initialize modules
      StorageManager.init();
      WorkoutHistory.init();

      // Initialize HistoryUI
      const historyContainer = document.getElementById("history-display");
      HistoryUI.init(historyContainer, WorkoutHistory);

      function showStatus(message, type = "success") {
        const statusDiv = document.getElementById("test-status");
        statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
      }

      function testEmptyState() {
        try {
          // Clear all history first
          WorkoutHistory.clearHistory();
          HistoryUI.renderHistory();
          showStatus("âœ… Empty state displayed successfully!");
        } catch (error) {
          showStatus(`âŒ Error: ${error.message}`, "error");
        }
      }

      function testWithSampleData() {
        try {
          // Clear existing data
          WorkoutHistory.clearHistory();

          // Add sample workouts with different types and modern data
          const sampleWorkouts = [
            {
              exercises: [
                {
                  name: "Push-ups",
                  sets: 3,
                  reps: 15,
                  muscleGroup: "chest",
                  equipment: "bodyweight",
                },
                {
                  name: "Squats",
                  sets: 3,
                  reps: 20,
                  muscleGroup: "legs",
                  equipment: "bodyweight",
                },
                {
                  name: "Plank",
                  duration: 60,
                  sets: 1,
                  reps: 1,
                  muscleGroup: "core",
                  equipment: "bodyweight",
                },
              ],
              type: "strength",
              duration: 30,
              difficulty: "intermediate",
            },
            {
              exercises: [
                {
                  name: "Running",
                  duration: 20,
                  sets: 1,
                  reps: 1,
                  muscleGroup: "legs",
                  equipment: "none",
                },
                {
                  name: "Jumping Jacks",
                  sets: 3,
                  reps: 30,
                  muscleGroup: "legs",
                  equipment: "bodyweight",
                },
                {
                  name: "Burpees",
                  sets: 2,
                  reps: 10,
                  muscleGroup: "core",
                  equipment: "bodyweight",
                },
              ],
              type: "cardio",
              duration: 25,
              difficulty: "beginner",
            },
            {
              exercises: [
                {
                  name: "Yoga Flow",
                  duration: 15,
                  sets: 1,
                  reps: 1,
                  muscleGroup: "core",
                  equipment: "mat",
                },
                {
                  name: "Stretching",
                  duration: 10,
                  sets: 1,
                  reps: 1,
                  muscleGroup: "back",
                  equipment: "none",
                },
                {
                  name: "Meditation",
                  duration: 5,
                  sets: 1,
                  reps: 1,
                  muscleGroup: "core",
                  equipment: "none",
                },
              ],
              type: "flexibility",
              duration: 30,
              difficulty: "beginner",
            },
          ];

          // Add workouts with slight delays to show different timestamps
          sampleWorkouts.forEach((workout, index) => {
            setTimeout(() => {
              // Add settings parameter that WorkoutHistory expects
              const settings = {
                muscleGroups: [
                  ...new Set(workout.exercises.map((ex) => ex.muscleGroup)),
                ],
                equipment: [
                  ...new Set(workout.exercises.map((ex) => ex.equipment)),
                ],
                timeLimit: workout.duration,
                difficulty: workout.difficulty,
                workoutType: workout.type,
              };

              WorkoutHistory.addWorkout(workout, settings);
              if (index === sampleWorkouts.length - 1) {
                // Render after all workouts are added
                setTimeout(() => {
                  HistoryUI.renderHistory();
                  showStatus("âœ… Sample workouts loaded with modern design!");
                }, 100);
              }
            }, index * 100);
          });
        } catch (error) {
          showStatus(`âŒ Error: ${error.message}`, "error");
        }
      }

      function testClearHistory() {
        try {
          WorkoutHistory.clearHistory();
          HistoryUI.renderHistory();
          showStatus("âœ… History cleared successfully!");
        } catch (error) {
          showStatus(`âŒ Error: ${error.message}`, "error");
        }
      }

      // Override HistoryUI methods for testing
      HistoryUI.repeatWorkout = (workoutId) => {
        showStatus(`ðŸ”„ User clicked Repeat for workout: ${workoutId}`);
      };

      HistoryUI.viewWorkoutDetails = (workoutId) => {
        showStatus(`ðŸ‘ï¸ User clicked View Details for workout: ${workoutId}`);
      };

      HistoryUI.deleteWorkout = (workoutId) => {
        try {
          WorkoutHistory.removeWorkout(workoutId);
          HistoryUI.renderHistory();
          showStatus(`ðŸ—‘ï¸ Workout deleted: ${workoutId}`);
        } catch (error) {
          showStatus(`âŒ Delete failed: ${error.message}`, "error");
        }
      };

      HistoryUI.clearAllHistory = () => {
        if (confirm("Are you sure you want to clear all workout history?")) {
          testClearHistory();
        }
      };

      // Initial render
      testEmptyState();
    </script>
  </body>
</html>
